# Copyright (C) 2020 Cancer Care Associates

# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at

#     http://www.apache.org/licenses/LICENSE-2.0

# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

version: "3.6"

services:
  physics-server-gitlab:
    restart: always
    image: gitlab/gitlab-ee:13.1.3-ee.0
    hostname: 'gitlab.physics-server'
    environment:
      GITLAB_OMNIBUS_CONFIG: |
        external_url 'http://gitlab.physics-server'
        gitlab_rails['gitlab_shell_ssh_port'] = 2224
    volumes:
      - 'gitlab-config:/etc/gitlab'
      - 'gitlab-logs:/var/log/gitlab'
      - 'gitlab-data:/var/opt/gitlab'
    ports:
      - "3780:80"
      - "2224:22"
volumes:
  gitlab-config:
  gitlab-logs:
  gitlab-data: